{"version":3,"file":"MonarcLibraryModal.js","names":["MonarcLibraryModal","_selectedObject$risks","_selectedObject$risks2","_React$useState","React","useState","_React$useState2","_slicedToArray","search","setSearch","_React$useState3","_React$useState4","objects","setObjects","_React$useState5","undefined","_React$useState6","selectedObject","setSelectedObject","_React$useState7","_React$useState8","importMethod","setImportMethod","url","window","location","href","match","numero","nonFormattedToken","localStorage","getItem","token","replace","headers","Headers","append","onSearchChange","event","target","value","useEffect","fetch","concat","then","response","json","console","log","error","selectAsset","object","uuid","importAsset","method","body","JSON","stringify","mode","changeImportMethod","createElement","className","i18next","t","style","color","type","name","id","checked","onChange","htmlFor","InputWithIcon","label","map","name1","category","label1","asset","description1","onClick","risks","length","risk","threatLabel1","vulnLabel1"],"sources":["../../../../../component/AnrRiskAnalysis/Modal/MonarcLibraryModal/MonarcLibraryModal.tsx"],"sourcesContent":["import * as ReactRedux from \"react-redux\";\r\nimport React from 'react'\r\n\r\nimport InputWithIcon from \"ng_client/component/Component/Inputs/InputWithIcon/InputWithIcon\";\r\nimport i18next from \"ng_client/node_modules/i18next/i18next.js\";\r\n\r\nimport { Object } from \"ng_client/component/interface/instanceInterface\"\r\n\r\n\r\nconst MonarcLibraryModal = () => {\r\n  const [search, setSearch] = React.useState('')\r\n\r\n  const [objects, setObjects] = React.useState<Object[]>([])\r\n\r\n  const [selectedObject, setSelectedObject] = React.useState<Object | undefined>(undefined)\r\n\r\n  const [importMethod, setImportMethod] = React.useState('merge')\r\n\r\n\r\n  var url = window.location.href;\r\n  var match = url.match(/\\/(\\d+)\\//);\r\n  var numero = match ? match[1] : null;\r\n\r\n  const nonFormattedToken = localStorage.getItem(\"ls.auth_token\");\r\n  const token = nonFormattedToken ? nonFormattedToken.replace(/\"/g, \"\") : null;\r\n\r\n  const headers = new Headers();\r\n  headers.append(\"Accept\", \"application/json, text/plain, */*\");\r\n  headers.append(\"Content-Type\", \"application/json\");\r\n  headers.append(\"Token\", token || \"\");\r\n\r\n  function onSearchChange(event) {\r\n    setSearch(event.target.value)\r\n  }\r\n\r\n  React.useEffect(() => {\r\n    fetch(`api/client-anr/${numero}/objects/import?filter=${search}`, {\r\n      headers: headers\r\n    })\r\n      .then(response => response.json())\r\n      .then(response => {\r\n        console.log(response)\r\n        setObjects(response.objects)\r\n      })\r\n      .catch(error => console.error(error));\r\n\r\n  }, [search])\r\n\r\n  function selectAsset(object) {\r\n\r\n    fetch(`api/client-anr/${numero}/objects/import/${object.uuid}`, {\r\n      headers: headers,\r\n    })\r\n      .then(response => response.json())\r\n      .then(response => {\r\n        console.log(response)\r\n        setSelectedObject(response)\r\n      })\r\n      .catch(error => console.error(error));\r\n  }\r\n\r\n  function importAsset() {\r\n    fetch(`api/client-anr/${numero}/objects/import/${selectedObject.uuid}`, {\r\n      headers: headers,\r\n      method: 'PATCH',\r\n      body: JSON.stringify({ object: selectedObject.uuid, mode: importMethod })\r\n    })\r\n      .then(response => response.json())\r\n      .then(response => {\r\n        console.log(response)\r\n      })\r\n      .catch(error => console.error(error));\r\n    setSelectedObject(undefined)\r\n  }\r\n\r\n  function changeImportMethod() {\r\n    if (importMethod === 'merge') {\r\n      setImportMethod('duplicate')\r\n    }\r\n    else {\r\n      setImportMethod('merge')\r\n    }\r\n  }\r\n\r\n  console.log(selectedObject)\r\n\r\n  return (\r\n    <div className=\"modal-alert\">\r\n      <div className=\"modal-user-fullscreen\">\r\n        <div className=\"d-flex justify-content-between primary-backgroundcolor\">\r\n          <h4 className=\"m-3\">{i18next.t('Asset import center')}</h4>\r\n          <button className=\"btn me-2\" /* onClick={props.showMonarcLibraryModal}  */style={{ color: 'white' }}>\r\n            <i className=\"bi bi-x-lg\"></i>\r\n          </button>\r\n        </div>\r\n        <div className=\"m-4\">\r\n          <div>\r\n            <span>{i18next.t('Import method')} :</span>\r\n            <div className=\"form-check\">\r\n              <input className=\"form-check-input\" type=\"radio\" name=\"flexRadioDefault\" id=\"flexRadioDefault1\" checked={importMethod === 'merge' ? false : true} onChange={changeImportMethod} />\r\n              <label className=\"form-check-label\" htmlFor=\"flexRadioDefault1\">{i18next.t('By duplicating')}</label>\r\n            </div>\r\n\r\n            <div className=\"form-check\">\r\n              <input className=\"form-check-input\" type=\"radio\" name=\"flexRadioDefault\" id=\"flexRadioDefault2\" checked={importMethod === 'merge' ? true : false} onChange={changeImportMethod} />\r\n              <label className=\"form-check-label\" htmlFor=\"flexRadioDefault2\">{i18next.t('By merging')}</label>\r\n            </div>\r\n            <span className=\"assetInfo p-3 my-3\">{i18next.t('Only global assets can be imported by merge')}</span>\r\n          </div>\r\n          {selectedObject === undefined ? (\r\n            <div>\r\n              <h3>{i18next.t('List of common MONARC assets')}</h3>\r\n              <InputWithIcon value={search} onChange={onSearchChange} label={i18next.t('Search an asset') + \"...\"} />\r\n              <table className=\"table table-striped table-hover table-bordered\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>{i18next.t('Name')}</th>\r\n                    <th>{i18next.t('Category')}</th>\r\n                    <th>{i18next.t('Asset Type')}</th>\r\n                    <th>{i18next.t('Actions')}</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {objects &&\r\n                    objects.map((object) => {\r\n                      return (\r\n                        <tr>\r\n                          <td>{object.name1}</td>\r\n                          <td>{object.category.label1}</td>\r\n                          <td>{object.asset.description1}</td>\r\n                          <td>\r\n                            <button className=\"btn btn-outline\" onClick={() => selectAsset(object)}>\r\n                              <i className=\"bi bi-arrow-up-right-square icon-large\"></i>\r\n                            </button>\r\n                          </td>\r\n                        </tr>\r\n                      );\r\n                    })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          ) : (\r\n            <div>\r\n              <div className=\"d-flex\">\r\n                <button className=\"btn btn-outline\" onClick={() => setSelectedObject(undefined)}>\r\n                {i18next.t('Back to the list')}\r\n                </button>\r\n                <button className=\"btn btn-outline\" onClick={importAsset}>\r\n                {i18next.t('Import asset')}\r\n                </button>\r\n              </div>\r\n              <div>\r\n                <h4>{selectedObject.name1}</h4>\r\n                <span>{selectedObject.risks?.length} {i18next.t('information risks')}</span>\r\n                <table className=\"table table-striped table-hover table-bordered\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th>{i18next.t('Threat')}</th>\r\n                      <th>{i18next.t('Vulnerability')}</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {selectedObject.risks?.map((risk) => {\r\n                      return (\r\n                        <tr>\r\n                          <td>{risk.threatLabel1}</td>\r\n                          <td>{risk.vulnLabel1}</td>\r\n                        </tr>\r\n                      );\r\n                    })}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MonarcLibraryModal"],"mappings":"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"}